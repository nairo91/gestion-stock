<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Stock Chantier</title>
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <nav class="navbar navbar-light bg-light fixed-top">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">Stock Chantier</span>
    </div>
  </nav>
  
  <div class="container" style="margin-top: 6rem;">

    <h1>Inventaire cumulé des livraisons vers chantier</h1>
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>ID</th>
          <th>Chantier</th>
          <th>Matériel</th>
          <th>Référence</th>
          <th>Emplacement</th>

          <th>Quantité Livrée</th>
        </tr>
      </thead>
      <tbody>
        <% if (materielChantiers && materielChantiers.length > 0) { %>
          <% materielChantiers.forEach(function(mc){ %>
            <tr>
              <td><%= mc.id %></td>
              <td>
                <% if(mc.chantier) { %>
                  <%= mc.chantier.nom %> - <%= mc.chantier.localisation %>
                <% } else { %>
                  N/A
                <% } %>
              </td>
              <td>
                <% if(mc.materiel) { %>
                  <%= mc.materiel.nom %>
                <% } else { %>
                  N/A
                <% } %>
              </td>

              <td>
                <% if(mc.materiel) { %>
                  <%= mc.materiel.reference %>
                <% } else { %>
                  -
                <% } %>
              </td>
              <td>
                <% if (mc.materiel && mc.materiel.emplacement) { %>
                  <%= mc.materiel.emplacement.nom %>
                <% } else { %>
                  -
                <% } %>
              </td>

              <td><%= mc.quantite %></td>
              <td>
                <a href="/chantier/materielChantier/modifier/<%= mc.id %>" class="btn btn-warning btn-sm">Modifier</a>
                <!-- Tu peux aussi ajouter un bouton pour supprimer ici -->
                <form action="/chantier/materielChantier/supprimer/<%= mc.id %>" method="POST" style="display:inline;" 
                  onsubmit="return confirm('Voulez-vous vraiment supprimer cet enregistrement ?');">
              <button type="submit" class="btn btn-danger btn-sm">Supprimer</button>
            </form>
            <a href="/chantier/materielChantier/dupliquer/<%= mc.id %>" class="btn btn-outline-primary btn-sm">Dupliquer</a>

              </td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="5" class="text-center">Aucune livraison enregistrée pour les chantiers.</td>
          </tr>
        <% } %>
      </tbody>
      
    </table>
    
   <!-- Boutons d'action -->
<div class="mt-3">
  <!-- <a href="/chantier/ajouter" class="btn btn-primary">Ajouter une livraison chantier</a>-->
  <a href="/chantier/ajouterMateriel" class="btn btn-success">Ajouter du matériel dans un chantier</a>
  <!-- Supprime le bouton "Modifier" global ici -->
  <a href="/chantier/ajouter-chantier" class="btn btn-success">Créer un nouveau chantier</a>
  <a href="/chantier/historique" class="btn btn-warning">Voir l'historique chantier</a>
  <a href="/emplacements" class="btn btn-info">Gérer les emplacements</a>

  <a href="/materiel" class="btn btn-secondary">Retour au Dashboard Dépôt</a>
</div>

  </div>
  
  <script src="/js/bootstrap.bundle.min.js"></script>
</body>
</html>
